# 데이터 누출 진단 결과 해석 가이드

## 📊 개요

이 가이드는 유사 사례 검색 시스템의 데이터 누출 진단 결과를 해석하는 방법을 설명합니다. 데이터 누출은 모델이 미래 정보를 사용하여 과도하게 좋은 성능을 보이는 현상으로, 실제 운영 환경에서 성능이 크게 저하될 수 있습니다.

## 🎯 주요 지표 해석

### 1. 전체 위험도 점수 (0-100점)

- **0-20점**: ✅ 매우 낮음 - 데이터 품질이 우수함
- **21-50점**: ⚠️ 보통 - 일부 중복이 있지만 허용 가능
- **51-80점**: 🚨 높음 - 심사 결과 중복이 많음
- **81-100점**: 🚨🚨 매우 높음 - 심각한 데이터 중복 문제

### 2. 핵심 지표별 의미

#### 📝 사고 내용 중복률
- **의미**: 동일한 사고 설명이 얼마나 반복되는지
- **정상 범위**: 20% 이하
- **해석**: 사고 내용 중복은 업무상 정상적인 현상 (유사한 사고가 자주 발생)

#### 🏷️ 심사 결과 중복률  
- **의미**: 동일한 심사항목명+상품심사항목명 조합이 얼마나 반복되는지
- **정상 범위**: 10% 이하
- **해석**: 심사 결과 중복은 데이터 누출의 주요 지표

#### ✅ 같은 사고, 다른 심사 결과
- **의미**: 사고 내용은 유사하지만 심사 결과가 다른 경우
- **정상 범위**: 높을수록 좋음 (30% 이상 권장)
- **해석**: 정상적인 업무 상황 (같은 사고라도 상황에 따라 다른 심사)

#### ❌ 같은 사고, 같은 심사 결과
- **의미**: 사고 내용과 심사 결과가 모두 동일한 경우
- **정상 범위**: 5% 이하
- **해석**: 데이터 중복의 문제가 될 수 있음

## 🔍 데이터 패턴 예시

### 정상적인 패턴 (문제없음)
```
사고 A: "교통사고로 인한 차량 손상"
심사 A: "교통사고보험|차량수리비"

사고 B: "교통사고로 인한 차량 손상" (유사한 텍스트)
심사 B: "교통사고보험|의료비" (다른 심사 결과)
```
→ **정상**: 같은 사고라도 상황에 따라 다른 심사 결과

### 문제가 될 수 있는 패턴
```
사고 A: "교통사고로 인한 차량 손상"
심사 A: "교통사고보험|차량수리비"

사고 B: "교통사고로 인한 차량 손상" (동일한 텍스트)
심사 B: "교통사고보험|차량수리비" (동일한 심사 결과)
```
→ **문제**: 완전히 동일한 데이터 중복

## 🚀 성능 최적화 정보

### 이전 문제점
- **O(n²) 복잡도**: 검증 데이터 × 학습 데이터만큼의 중첩 루프
- **매번 새로운 임베딩 생성**: 각 비교마다 텍스트 임베딩 재계산
- **진행 상황 불투명**: 사용자가 프로세스가 멈췄는지 알 수 없음

### 최적화된 해결책
- **사전 임베딩 계산**: 모든 텍스트의 임베딩을 한 번에 미리 계산
- **벡터화된 유사도 계산**: numpy를 활용한 효율적인 유사도 계산
- **진행률 표시**: 10% 단위로 진행 상황을 실시간 표시
- **캐시 활용**: 이미 계산된 임베딩 재사용

### 성능 개선 효과
- **속도**: 기존 대비 약 10-50배 빠른 실행
- **메모리 효율성**: 중복 계산 제거로 메모리 사용량 감소
- **사용자 경험**: 진행 상황을 실시간으로 확인 가능

## 📋 권장사항

### 위험도가 낮은 경우 (0-20점)
- ✅ 현재 데이터셋으로 모델 사용 가능
- ✅ 정상적인 업무 패턴이 반영됨
- ✅ 추가 조치 불필요

### 위험도가 보통인 경우 (21-50점)
- ⚠️ 결과를 신중하게 해석
- 📊 추가적인 검증 데이터로 테스트 권장
- 🔄 정기적인 모니터링 필요

### 위험도가 높은 경우 (51점 이상)
- 🚨 데이터 품질 개선 필요
- 🔍 중복 데이터 제거 또는 수정
- 📈 더 다양한 데이터 수집 고려
- ⚠️ 모델 성능이 현실과 다를 수 있음

## 🔧 데이터 품질 개선 방법

### 1. 중복 데이터 제거
```python
# 동일한 사고+심사 조합 제거
df = df.drop_duplicates(subset=['사고설명', '심사항목명', '상품심사항목명'])
```

### 2. 데이터 다양성 확보
- 다양한 사고 유형 추가
- 다양한 심사 결과 패턴 수집
- 지역별, 시간별 분포 고려

### 3. 정기적인 모니터링
- 월별 데이터 누출 진단 실행
- 새로운 데이터 추가 시 재검증
- 모델 성능 변화 추적

## 📞 추가 지원

데이터 누출 진단 결과에 대한 추가 질문이나 데이터 품질 개선 방법에 대해 궁금한 점이 있으시면 언제든 문의해주세요. 